{%-extends "base.html"-%}

{%-block head-%}
{%-endblock-%}

{%-block content-%}
<div class="row g-3 m-0 p-4 justify-content-center w-100">
    <div class="col-lg-12">
        <p class="fs-5 text-uppercase text-secondary text-center">Register</p>
    </div>
    <form class="col-lg-6" action="{{url_for('user.register')}}" method="post" onsubmit="submitRegistration(this); return false">
        <div class="input-group mb-2">
            <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
            <input name="username" class="form-control" type="text" placeholder="Username" value="{%-if username-%}{{username}}{%-endif-%}" required>
        </div>
        <div class="input-group mb-2">
            <span class="input-group-text"><i class="bi bi-key-fill"></i></span>
            <input name="password" class="form-control" type="password" placeholder="Password" required>
        </div>
        <div class="input-group mb-2">
            <span class="input-group-text"><i class="bi bi-key"></i></span>
            <input name="password2" class="form-control" type="password" placeholder="Confirm Password" onkeyup="validatePassword()" required>
        </div>
        <div id="pass2-notice" class="mb-2 text-center" hidden><span class="text-danger">Passwords doesn't match</span></div>
        <div class="d-grid text-center">
            <button type="submit" class="btn">Register</button>
        </div>
        {%-if error-%}<div class="mt-2 text-center text-danger" >{{error.capitalize()}}</div>{%-endif-%}
    </form>
</div>
{%-endblock-%}

{%-block footer-%}
<script>
    var pass1 = document.querySelector('input[name="password"]');
    var pass2 = document.querySelector('input[name="password2"]');
    var pass2_notice = document.getElementById('pass2-notice');
    function validatePassword() {
        if ( pass1.value === pass2.value ) {
            pass2_notice.hidden = true;
            return true;
        } else {
            pass2_notice.hidden = false;
            return false
        }
    }
    function submitRegistration(element) {
        if ( validatePassword() == true ) {
            element.submit();
        }
    }
</script>
{%-endblock-%}